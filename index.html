<html>
<script type="text/javascript">

//  |\___/|
// =) ^Y^ (=   I'm in ur codez.
//  \  ^  /    Ignoring ur best practicez.
//   )=*=(

window.onload = setupRefresh;
var imageAddr = "http://upload.wikimedia.org/wikipedia/commons/a/a6/Standard_Poodle_portrait.jpg" + "?n=" + Math.random();
var startTime, endTime;
var downloadSize = 6000271; // number of kittehs. [needs citation]
var download = new Image();
var speedBps, speedKbps, speedMbps;
var img = document.createElement("img");
var images = new Array();
var a = 1;
//finish speed test after image loadz
download.onload = function(e) {
endTime = (new Date()).getTime();
showResults ();
}

//show result of complex highly accurate speed test
function showResults () {
	var duration = Math.round((endTime - startTime) / 1000);
	var bitsLoaded = downloadSize * 8;
	var speedBps = Math.round(bitsLoaded / duration);
	var speedKbps = (speedBps / 1024).toFixed(2);
	var speedMbps = (speedKbps / 1024).toFixed(2);
	//alert ("Your connection speed is: \n" +
	//speedBps + " bps\n" +
	//speedKbps + " kbps\n" +
	//speedMbps + " Mbps\n");
	//speedMbps = 99;
	if(speedMbps<4)
		{
		//you no haz kittehs
		var container = document.getElementById("imageContainer");
		container.appendChild(download);
		document.getElementById('some_text').innerHTML = speedMbps+" Mbps - You no haz kittehs.";
		}
	else
		{
		//you haz kittehs
		var container = document.getElementById("imageContainer");
		container.appendChild(img);
		document.getElementById('some_text').innerHTML = speedMbps+" Mbps - You haz kittehs.";
		}
}

//setup periodic refresh...for moar kittehs when allowed.
function setupRefresh() {
	setInterval("refreshFrame();", 1000);
}
//periodic function called to get moar kitteh goodness.
function refreshFrame()
	{
	if(a >= images.length){
		a=0;
	}else{
		img.setAttribute("src",""+images[a]);
		img.setAttribute("height","500");
		img.setAttribute("width","500");
		a++;
	}
}
//some images in der array.
images.push("img.jpg");
images.push("http://o.onionstatic.com/images/7/7954/original/700.hq.jpg");
images.push("http://www.deshow.net/d/file/animal/2009-07/cute-kitten-631-2.jpg");
images.push("http://us.123rf.com/400wm/400/400/grivet/grivet1007/grivet100700006/7283526-adorable-yawning-kitten-and-looking-foward.jpg");
images.push("http://www.warrenphotographic.co.uk/photography/bigs/27878-Tabby-kitten-white-background.jpg");
images.push("http://us.123rf.com/400wm/400/400/podlesnova/podlesnova0906/podlesnova090600034/5117393-small-red-furry-kitten-with-blue-eyes.jpg");
images.push("http://3.bp.blogspot.com/-4kBvHvCJnOY/T-iKBteyTKI/AAAAAAAABLw/CwDU11DBqWc/s1600/kitten.jpeg");
images.push("http://images2.fanpop.com/images/photos/5800000/happy-kitten-kittens-5890512-1600-1200.jpg");
images.push("http://thepersiankittens.com/Persian_Kittens.jpg");
images.push("http://forum.i3d.net/attachments/offtopic-english/943147141d1221752968-lolcat-conversation-thread-441249.jpg");
images.push("http://mintyferret.com/wp-content/uploads/2007/07/lolcat7.gif");
images.push("http://lolcat.com/images/lolcats/1338.jpg");
images.push("http://images4.fanpop.com/image/photos/16100000/Cute-Kitten-kittens-16122946-1280-800.jpg");
images.push("http://www.hyperinkpress.com/images/kittenphotos/image83.jpg");
images.push("http://www.warrenphotographic.co.uk/photography/bigs/37027-Tabby-kittens-lounging-together-white-background.jpg");
images.push("http://images2.fanpop.com/images/photos/5900000/Kittens-cats-5979907-2560-1817.jpg");
images.push("http://www.warrenphotographic.co.uk/photography/bigs/10122-Silver-and-red-kittens-white-background.jpg");
images.push("http://wordandimage.files.wordpress.com/2008/04/lolcat-attack.png");
images.push("http://www.boredstop.com/imgp/lolcat3.jpg");
images.push("http://whitsblog.com/wp-content/uploads/2011/10/lolcat_what1.jpg");
images.push("http://cache.ohinternet.com/images/b/b0/Lolcat.JPG");
images.push("http://merereflections.org/wp-content/uploads/2011/04/lolcat-funny-picture-found-pills-ate-eat1.jpg");
images.push("http://lolcat.com/images/lolcats/1338.jpg");
images.push("http://talklikeaphysicist.com/wp-content/uploads/2009/03/phyics-lolcat.jpg");
images.push("http://simplegreenorganichappy.com/wp-content/uploads/2010/09/cute-lolcat-ears-hear-you.jpg");
images.push("https://a248.e.akamai.net/camo.github.com/c546f5fddb8e9e242449b8178ecc77edd0f38e00/687474703a2f2f69332e70686f746f6275636b65742e636f6d2f616c62756d732f7938332f53706163654769726c333930302f4c4f4c4361742d5261696e626f772e6a7067");

// Start test
startTime = (new Date()).getTime();
download.src = imageAddr;
download.setAttribute("height","500");
download.setAttribute("width","500");

</script>
<body>
<div id="imageContainer"></div><div style="font-size:50px" id="some_text">Running speed test. Standby...</div>
</body>
</html>
